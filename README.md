# Toll Fee Calculator

A calculator for vehicle toll fees.

## Background

Our city has decided to implement toll fees in order to reduce traffic congestion during rush hours. This is the current draft of requirements:

- Fees will differ between 8 SEK and 18 SEK, depending on the time of day
- Rush-hour traffic will render the highest fee
- The maximum fee for one day is 60 SEK
- A vehicle should only be charged once an hour
- In the case of multiple fees in the same hour period, the highest one applies.
- Some vehicle types are fee-free
- Weekends and holidays are fee-free


## Assumptions

I made the assumption that the toll fee calculator is handling not just the calculations but also the data generated by the tollgates.
The calculator exposes a REST API endpoint to receive the toll passage information from the tollgates.
The payload includes the vehicle number and the time at which it crossed the gate. 
I also included the vehicle type, though I believe it is unlikely a tollgate would have that kind of information. It is more likely that this information is available through an API call but for the sake of this exercise, I kept it that way.

The information received from the tollgates is stored in a repository (normally a database but in this case RAM) and is accessed when the calculator performs the actual calculations.

The calculations are performed once a day, and are initiated by a scheduler.

The results are to be sent to an external API that will take care of managing the payments.

Here is a drawing that depicts the overall functioning of the toll fee calculator.
![Screenshot 2024-09-10 at 21 18 09](https://github.com/user-attachments/assets/7515b5c1-9f1a-4230-91f3-ffbd76f32dd5)


## And if this was a real assignment

There would be a lot left to do :)
Among other things:
- Error handling: it was not implemented here, but there are a lot of cases where things can go wrong (interacting with the repositories for example). Error handling would address issues without the code crashing.
- CI/CD: 
  - running tests, linting (and others) automatically when submitting code to the repo
  - a deployment pipeline (deploying to a test environment before deploying to production for example)
- More tests: as of now there are a few unit tests, more would be needed. End-to-end tests should be added too.
- Persistent storage: access to existing databases or creating required databases
- A place where to send the toll fee calculations results
- Message queue: to handle the incoming requests from the tollgates to minimise the time the spent connected to the endpoint and to ensure no data is lost even in case of failure
- API key so that the endpoint is not open!
- environmental variables
- etc

And of course there would have been a discussion with the relevant people (PO, PM, technical teams, etc) to clarify the questions exposed in the assumptions section.
There would also have been a whole deal of project management, with planning work, prioritising tasks, reviewing work, etc.
